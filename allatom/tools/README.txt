This document describes the generation of ATTRACT topology and parameters from CNS or Amber format.
See allatom.txt for more technical detail.

*********************************************************************************************************
Input:
CNS:
	- A CNS parameter file. This file must contain NONBONDED statements for all the desired atom types (other statements are ignored).
	Example: oplsx.par
	- A CNS topology file. Example: topallhdg.pro
OR:
Amber:
  - The parmed Python library must be installed.
  - AMBER nonbonded parameters for all the desired atom types.
	  In theory, these could be read from an AMBER forcefield (.dat) file, but this format is not well-defined
	   and there are no high-quality tools to parse them.
		Instead, you should use AmberTools to create a .prmtop file that contains all the desired atom types.
	- One or more AMBER .lib/.off files containing the residue topology.

Steps:

1. Convert the parameter file to a trans file using the trans_par.py (CNS) or trans_par_amber tool.
	The "start" parameter specifies an offset for ATTRACT atom types; 75 or 33 would make sense to avoid overlap with the standard reduced atom types.
	Examples:
	  python trans_par.py oplsx.par 75 > oplsx.trans
	  python trans_par_amber.py gag/gag.prctop 1 > gag.trans
	The trans file contains the ATTRACT atom type (a number), the VdW radius parameters, and a list of CNS atom types (code strings).

2. Edit the trans file. In general, it is best to assign different ATTRACT atom type numbers than 1-31 (the reduced ones).
Example: oplsx.trans

3. Generate the ATTRACT parameters using the gen_par tool
	Example: python gen_par.py allatom.trans > ../allatom.par
	To create a combined file for DNA, RNA and protein, first concatenate/combine different trans files into allatom.trans.

4. Generate the ATTRACT topology file that will be used by aareduce.py.
   CNS:
	   Use the parse_cns_top tool:
		   python parse_cns_top.py <name> <CNS topology file(s)>
		 Examples:
		   python parse_cns_top.py oplsx oplsx/topallhdg5.3.pro  > ../oplsx-top.json
                   python parse_cns_top.py dna-rna oplsx/dna-rna-allatom.top  > ../dna-rna-top.json
	 AMBER:
	   Use the parse_amber_lib tool:
		   python parse_amber_lib.py <name> <AMBER .off/.lib file(s)>
		 Examples:
		   python parse_amber_lib.py gag gag/*.lib  > ../gag-top.json

C. Usage
=====================================================================================================================================

4. Use allatom/aareduce.py to reduce your PDBs. This requires the trans file and the ATTRACT topology file.
	 python aareduce.py mypdb.pdb --trans file.trans --top file-top.json
	 By default, opls.trans and oplsx-top.json are loaded.


5. Run ATTRACT normally, using the same parameters.
	- Use the all-atom "reduced" PDB files as generated by aareduce
	- Instead of attract.par, use the .par file generated in step 3.
	- Use a constant dielectric by setting the --cdie flag. The recommended value is 10. This can be set with --epsilon 10.
	- If you use a grid, use make-grid with --cdie and --epsilon 10 as well. It is also recommended to specify --alphabet <trans file> to save time and space.

*********************************************************************************************************
